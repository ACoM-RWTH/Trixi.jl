module TestExamples3DLatticeBoltzmann

using Test
using Trixi

include("test_trixi.jl")

# pathof(Trixi) returns /path/to/Trixi/src/Trixi.jl, dirname gives the parent directory
EXAMPLES_DIR = joinpath(pathof(Trixi) |> dirname |> dirname, "examples", "3d")

@testset "Lattice-Boltzmann" begin
  @testset "elixir_lbm_constant.jl" begin
    @test_trixi_include(joinpath(EXAMPLES_DIR, "elixir_lbm_constant.jl"),
      l2   = [5.861930511199053e-16, 6.282772442363201e-16, 5.47591540767842e-16,
              6.379244339335046e-16, 5.81421258408584e-16, 6.634626069779352e-16,
              2.9188639102691596e-16, 2.1539168764807097e-16, 3.0131714783573674e-16,
              2.2126555191449657e-16, 2.622901122013102e-16, 2.2115776381362187e-16,
              6.32031843208421e-17, 6.103875364141341e-17, 6.821138567646266e-17,
              6.48022057541854e-17, 5.013642264182462e-17, 7.169498358338181e-17,
              1.3879946832660896e-16, 5.649850447603551e-17, 3.4686869828797276e-17,
              3.8719518141614167e-17, 3.5852179230919525e-17, 4.292415147083455e-17,
              3.608945206319316e-17, 4.187850903422495e-17, 8.254587760492495e-16],
      linf = [1.1657341758564144e-15, 1.5543122344752192e-15, 1.1657341758564144e-15,
              1.4710455076283324e-15, 1.0547118733938987e-15, 1.4988010832439613e-15,
              5.273559366969494e-16, 5.065392549852277e-16, 5.967448757360216e-16,
              5.342948306008566e-16, 5.412337245047638e-16, 5.967448757360216e-16,
              3.608224830031759e-16, 3.469446951953614e-16, 2.42861286636753e-16,
              2.498001805406602e-16, 2.2898349882893854e-16, 4.3021142204224816e-16,
              2.1510571102112408e-16, 1.43982048506075e-16, 1.214306433183765e-16,
              1.4224732503009818e-16, 1.214306433183765e-16, 1.3877787807814457e-16,
              8.673617379884035e-17, 9.71445146547012e-17, 2.7755575615628914e-15],
      tspan=(0.0, 0.5))
  end
end

end # module
