module TestExamples3DLatticeBoltzmann

using Test
using Trixi

include("test_trixi.jl")

# pathof(Trixi) returns /path/to/Trixi/src/Trixi.jl, dirname gives the parent directory
EXAMPLES_DIR = joinpath(pathof(Trixi) |> dirname |> dirname, "examples", "3d")

@testset "Lattice-Boltzmann" begin
  @testset "elixir_lbm_constant.jl" begin
    @test_trixi_include(joinpath(EXAMPLES_DIR, "elixir_lbm_constant.jl"),
      l2   = [1.1141268306666197e-16, 4.312535803851083e-17,  1.1146822691063905e-16,
              4.053660373029963e-17,  1.1102230246251607e-16, 4.6791075785341645e-17,
              3.528535471449796e-17,  3.489149141983059e-17,  3.4847923630149675e-17,
              3.4210219412925945e-17, 3.451733693543442e-17,  3.458932345673096e-17,
              8.390062305881406e-18,  9.578194773700555e-18,  8.928288058554188e-18,
              8.525427152911749e-18,  9.186922021166244e-18,  8.659094110087814e-18,
              1.9760815283422227e-17, 4.505342573050186e-18,  7.656669973678736e-18,
              1.5682888534557012e-18, 8.129888274646796e-18,  2.9025851184305817e-18,
              7.525243997582179e-18,  2.6801111566975107e-18, 1.3445889162506796e-16],
      linf = [1.6653345369377348e-16, 1.1102230246251565e-16, 1.6653345369377348e-16,
              1.3877787807814457e-16, 1.1102230246251565e-16, 1.6653345369377348e-16,
              6.938893903907228e-17,  4.85722573273506e-17,   6.938893903907228e-17,
              4.85722573273506e-17,   6.938893903907228e-17,  4.85722573273506e-17,
              2.0816681711721685e-17, 2.7755575615628914e-17, 2.0816681711721685e-17,
              2.7755575615628914e-17, 2.0816681711721685e-17, 2.7755575615628914e-17,
              3.122502256758253e-17,  8.673617379884035e-18,  1.3877787807814457e-17,
              5.204170427930421e-18,  1.734723475976807e-17,  6.938893903907228e-18,
              1.3877787807814457e-17, 8.673617379884035e-18,  3.3306690738754696e-16],
      maxiters = 2)
  end
end

end # module
